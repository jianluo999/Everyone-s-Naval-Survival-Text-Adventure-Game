<template>
  <div class="cabin-demo">
    <div class="demo-header">
      <h1>ğŸš¢ ç¬¬ä¸€è§†è§’èˆ¹èˆ±ç¯å¢ƒæ¼”ç¤º</h1>
      <div class="demo-controls">
        <el-button @click="$router.push('/game')" type="primary">
          <el-icon><ArrowLeft /></el-icon>
          è¿”å›æ¸¸æˆ
        </el-button>
        <el-button @click="toggleWeather" :type="weatherType">
          {{ weatherLabels[currentWeather] }}
        </el-button>
        <el-button @click="toggleTime" :type="timeType">
          {{ timeLabels[currentTime] }}
        </el-button>
        <el-button disabled type="info">
          ğŸµ éŸ³æ•ˆæš‚æœªå¯ç”¨
        </el-button>
      </div>
    </div>

    <!-- èˆ¹èˆ±ç¯å¢ƒ -->
    <div class="demo-cabin">
      <div class="cabin-placeholder">
        <div class="cabin-frame">
          <h2>ğŸš¢ èˆ¹èˆ±ç¯å¢ƒæ¼”ç¤º</h2>
          <p>3Dèˆ¹èˆ±ç¯å¢ƒå·²ç®€åŒ–ï¼Œé¿å…ç»„ä»¶å†²çª</p>
          <div class="cabin-preview">
            <div class="preview-item">ğŸªŸ èˆ·çª—è§†é‡</div>
            <div class="preview-item">ğŸ§­ å¯¼èˆªä»ªè¡¨</div>
            <div class="preview-item">ğŸ“š èˆ¹èˆ±ç‰©å“</div>
            <div class="preview-item">âš“ ç¯å¢ƒæ•ˆæœ</div>
          </div>
        </div>
      </div>
    </div>

    <!-- ç¯å¢ƒä¿¡æ¯é¢æ¿ -->
    <div class="environment-panel">
      <div class="panel-section">
        <h3>ğŸŒŠ ç¯å¢ƒçŠ¶æ€</h3>
        <div class="status-grid">
          <div class="status-item">
            <span class="label">å¤©æ°”:</span>
            <span class="value">{{ weatherLabels[currentWeather] }}</span>
          </div>
          <div class="status-item">
            <span class="label">æ—¶é—´:</span>
            <span class="value">{{ timeLabels[currentTime] }}</span>
          </div>
          <div class="status-item">
            <span class="label">æµ·å†µ:</span>
            <span class="value">{{ seaConditions[currentWeather] }}</span>
          </div>
        </div>
      </div>

      <div class="panel-section">
        <h3>ğŸ® äº¤äº’æç¤º</h3>
        <div class="interaction-tips">
          <div class="tip">
            <el-icon><View /></el-icon>
            <span>ç‚¹å‡»èˆ·çª—è§‚å¯Ÿæµ·é¢</span>
          </div>
          <div class="tip">
            <el-icon><Compass /></el-icon>
            <span>ç‚¹å‡»ç½—ç›˜æŸ¥çœ‹æ–¹å‘</span>
          </div>
          <div class="tip">
            <el-icon><Search /></el-icon>
            <span>ç‚¹å‡»æœ›è¿œé•œè¿œçœº</span>
          </div>
          <div class="tip">
            <el-icon><Reading /></el-icon>
            <span>ç‚¹å‡»ä¹¦æ¶é˜…è¯»</span>
          </div>
          <div class="tip">
            <el-icon><Sunny /></el-icon>
            <span>ç‚¹å‡»æ²¹ç¯æ§åˆ¶ç…§æ˜</span>
          </div>
        </div>
      </div>

      <div class="panel-section">
        <h3>ğŸ”§ æŠ€æœ¯ç‰¹æ€§</h3>
        <div class="features-list">
          <div class="feature">âœ¨ CSS 3Då˜æ¢æ„å»ºç«‹ä½“ç©ºé—´</div>
          <div class="feature">ğŸŒŠ åŠ¨æ€æµ·æµªå’Œå¤©ç©ºæ•ˆæœ</div>
          <div class="feature">âš¡ å®æ—¶èˆ¹åªæ‘‡æ‘†åŠ¨ç”»</div>
          <div class="feature">ğŸµ Web Audio APIç¯å¢ƒéŸ³æ•ˆ</div>
          <div class="feature">ğŸ–±ï¸ ä¸°å¯Œçš„äº¤äº’å…ƒç´ </div>
          <div class="feature">ğŸ“± å“åº”å¼è®¾è®¡é€‚é…</div>
        </div>
      </div>
    </div>

    <!-- éŸ³æ•ˆè¯´æ˜é¢æ¿ -->
    <div class="sound-panel">
      <h4>ğŸµ éŸ³æ•ˆç³»ç»Ÿ</h4>
      <div class="sound-info">
        <p>éŸ³æ•ˆç³»ç»Ÿæš‚æ—¶ç¦ç”¨ï¼Œé¿å…å…¼å®¹æ€§é—®é¢˜</p>
        <p>æœªæ¥ç‰ˆæœ¬å°†æ”¯æŒï¼š</p>
        <ul>
          <li>ğŸŒŠ æµ·æµªå£°</li>
          <li>ğŸ’¨ é£å£°</li>
          <li>ğŸŒ§ï¸ é›¨å£°</li>
          <li>ğŸ¦ æµ·é¸¥å«å£°</li>
          <li>âš“ èˆ¹åªå±å˜å£°</li>
        </ul>
      </div>
    </div>
  </div>
</template>

<script setup>
import { ref, onMounted, onUnmounted } from 'vue'
import { useRouter } from 'vue-router'
import { ArrowLeft, View, Compass, Search, Reading, Sunny } from '@element-plus/icons-vue'
// import ShipCabin from '@/components/ShipCabin.vue' // æš‚æ—¶æ³¨é‡Šé¿å…å†²çª
// import { ambientSounds } from '@/utils/ambientSounds' // æš‚æ—¶æ³¨é‡Šé¿å…å†²çª

const router = useRouter()
const cabinRef = ref(null)

// ç¯å¢ƒçŠ¶æ€
const currentWeather = ref('calm')
const currentTime = ref('day')
const soundEnabled = ref(true)
const volume = ref(30)

// æ ‡ç­¾æ˜ å°„
const weatherLabels = {
  calm: 'ğŸŒ… å¹³é™',
  windy: 'ğŸ’¨ å¤šé£',
  storm: 'â›ˆï¸ æš´é£é›¨',
  foggy: 'ğŸŒ«ï¸ å¤šé›¾'
}

const timeLabels = {
  dawn: 'ğŸŒ… é»æ˜',
  day: 'â˜€ï¸ ç™½å¤©',
  dusk: 'ğŸŒ‡ é»„æ˜',
  night: 'ğŸŒ™ å¤œæ™š'
}

const seaConditions = {
  calm: 'é£å¹³æµªé™',
  windy: 'ä¸­ç­‰æµ·æµª',
  storm: 'å·¨æµªæ»”å¤©',
  foggy: 'èƒ½è§åº¦ä½'
}

// è®¡ç®—å±æ€§
const weatherType = ref('primary')
const timeType = ref('success')

// åˆ‡æ¢å¤©æ°”
const toggleWeather = () => {
  const weathers = ['calm', 'windy', 'storm', 'foggy']
  const currentIndex = weathers.indexOf(currentWeather.value)
  currentWeather.value = weathers[(currentIndex + 1) % weathers.length]
  console.log('å¤©æ°”åˆ‡æ¢åˆ°:', currentWeather.value)
}

// åˆ‡æ¢æ—¶é—´
const toggleTime = () => {
  const times = ['dawn', 'day', 'dusk', 'night']
  const currentIndex = times.indexOf(currentTime.value)
  currentTime.value = times[(currentIndex + 1) % times.length]
  console.log('æ—¶é—´åˆ‡æ¢åˆ°:', currentTime.value)
}

// éŸ³æ•ˆç›¸å…³æ–¹æ³•ï¼ˆæš‚æ—¶ç¦ç”¨ï¼‰
const toggleSound = () => {
  console.log('éŸ³æ•ˆåˆ‡æ¢ï¼ˆæš‚æ—¶ç¦ç”¨ï¼‰')
}

const updateVolume = (value) => {
  console.log('éŸ³é‡è°ƒèŠ‚ï¼ˆæš‚æ—¶ç¦ç”¨ï¼‰:', value)
}

const playSound = (soundType) => {
  console.log('æ’­æ”¾éŸ³æ•ˆï¼ˆæš‚æ—¶ç¦ç”¨ï¼‰:', soundType)
}

// ç”Ÿå‘½å‘¨æœŸ
onMounted(() => {
  console.log('èˆ¹èˆ±æ¼”ç¤ºé¡µé¢å·²åŠ è½½')
})

onUnmounted(() => {
  console.log('èˆ¹èˆ±æ¼”ç¤ºé¡µé¢å·²å¸è½½')
})
</script>

<style lang="scss" scoped>
.cabin-demo {
  position: relative;
  width: 100%;
  height: 100vh;
  overflow: hidden;
  background: linear-gradient(
    to bottom,
    #0a1929 0%,
    #1e3a8a 50%,
    #0f172a 100%
  );
}

.demo-header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 1000;
  background: rgba(0, 20, 40, 0.9);
  backdrop-filter: blur(10px);
  border-bottom: 2px solid #66ffcc;
  padding: 1rem 2rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  
  h1 {
    color: #66ffcc;
    margin: 0;
    font-size: 1.5rem;
    text-shadow: 0 0 10px rgba(102, 255, 204, 0.5);
  }
}

.demo-controls {
  display: flex;
  gap: 1rem;
  align-items: center;
}

.demo-cabin {
  width: 100%;
  height: 100%;
  margin-top: 80px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.cabin-placeholder {
  background: rgba(0, 20, 40, 0.9);
  border: 2px solid #66ffcc;
  border-radius: 12px;
  padding: 2rem;
  backdrop-filter: blur(10px);
  text-align: center;
  max-width: 600px;
}

.cabin-frame {
  h2 {
    color: #66ffcc;
    margin: 0 0 1rem 0;
    text-shadow: 0 0 10px rgba(102, 255, 204, 0.5);
  }

  p {
    color: #ccc;
    margin: 0 0 1.5rem 0;
    line-height: 1.5;
  }
}

.cabin-preview {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1rem;
  margin-top: 1.5rem;
}

.preview-item {
  background: rgba(102, 255, 204, 0.1);
  border: 1px solid #66ffcc;
  border-radius: 8px;
  padding: 1rem;
  color: #66ffcc;
  font-size: 0.9rem;
  transition: all 0.3s ease;

  &:hover {
    background: rgba(102, 255, 204, 0.2);
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(102, 255, 204, 0.3);
  }
}

.environment-panel {
  position: fixed;
  top: 100px;
  right: 20px;
  width: 300px;
  background: rgba(0, 20, 40, 0.9);
  border: 2px solid #66ffcc;
  border-radius: 12px;
  padding: 1rem;
  backdrop-filter: blur(10px);
  z-index: 999;
  max-height: calc(100vh - 120px);
  overflow-y: auto;
}

.panel-section {
  margin-bottom: 1.5rem;
  
  h3 {
    color: #66ffcc;
    margin: 0 0 0.5rem 0;
    font-size: 1rem;
    border-bottom: 1px solid rgba(102, 255, 204, 0.3);
    padding-bottom: 0.25rem;
  }
}

.status-grid {
  display: grid;
  gap: 0.5rem;
}

.status-item {
  display: flex;
  justify-content: space-between;
  
  .label {
    color: #ccc;
    font-size: 0.9rem;
  }
  
  .value {
    color: #FFD700;
    font-weight: bold;
    font-size: 0.9rem;
  }
}

.interaction-tips {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.tip {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  color: #ccc;
  font-size: 0.85rem;
  
  .el-icon {
    color: #66ffcc;
  }
}

.features-list {
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
}

.feature {
  color: #ccc;
  font-size: 0.85rem;
  padding: 0.25rem 0;
}

.sound-panel {
  position: fixed;
  bottom: 20px;
  left: 20px;
  background: rgba(0, 20, 40, 0.9);
  border: 2px solid #66ffcc;
  border-radius: 12px;
  padding: 1rem;
  backdrop-filter: blur(10px);
  z-index: 999;
  
  h4 {
    color: #66ffcc;
    margin: 0 0 0.5rem 0;
    font-size: 0.9rem;
  }
}

.sound-info {
  color: #ccc;
  font-size: 0.85rem;
  line-height: 1.4;

  p {
    margin: 0.5rem 0;
  }

  ul {
    margin: 0.5rem 0;
    padding-left: 1rem;

    li {
      margin: 0.25rem 0;
    }
  }
}

// å“åº”å¼è®¾è®¡
@media (max-width: 768px) {
  .demo-header {
    flex-direction: column;
    gap: 1rem;
    padding: 1rem;
    
    h1 {
      font-size: 1.2rem;
    }
  }
  
  .demo-controls {
    flex-wrap: wrap;
    justify-content: center;
  }
  
  .environment-panel {
    position: relative;
    top: auto;
    right: auto;
    width: calc(100% - 40px);
    margin: 20px;
    max-height: none;
  }
  
  .sound-panel {
    position: relative;
    bottom: auto;
    left: auto;
    margin: 20px;
  }
  
  .demo-cabin {
    margin-top: 140px;
    height: calc(100vh - 140px);
  }
}

// è‡ªå®šä¹‰æ»šåŠ¨æ¡
.environment-panel::-webkit-scrollbar {
  width: 6px;
}

.environment-panel::-webkit-scrollbar-track {
  background: rgba(0, 40, 80, 0.3);
  border-radius: 3px;
}

.environment-panel::-webkit-scrollbar-thumb {
  background: #66ffcc;
  border-radius: 3px;
  
  &:hover {
    background: #FFD700;
  }
}
</style>
